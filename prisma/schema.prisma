// prisma/schema.prisma
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Producto {
  id          Int      @id @default(autoincrement())
  nombre      String
  descripcion String
  precio      Float
  stock       Int
  pedidos     Pedido[] // Relación uno-a-muchos con pedidos
}

model Pedido {
  id          Int       @id @default(autoincrement())
  fecha       DateTime  @default(now())
  cantidad    Int
  total       Float
  producto    Producto  @relation(fields: [productoId], references: [id])
  productoId  Int
  usuario     Usuario   @relation(fields: [usuarioId], references: [id])
  usuarioId   Int
  emails      Email[]   // Relación inversa: un pedido puede tener varios emails
}

model Usuario {
  id       Int      @id @default(autoincrement())
  email    String   @unique
  password String
  nombre   String
  rol      String   // ej. "CLIENTE", "JEFE_VENTAS", etc.
  pedidos  Pedido[]
}

model Email {
  id        Int      @id @default(autoincrement())
  to        String
  subject   String
  body      String
  sentAt    DateTime @default(now())
  pedidoId  Int?
  pedido    Pedido?  @relation(fields: [pedidoId], references: [id])
}
